var ae=Object.defineProperty;var oe=(i,e,t)=>e in i?ae(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var o=(i,e,t)=>oe(i,typeof e!="symbol"?e+"":e,t);class ce{constructor(){o(this,"loadedFonts",new Set);o(this,"fetcher",fetch)}setFetcher(e){this.fetcher=e}async loadFonts(e,t){const r=new Function("m","return import(m)"),s=this.fetcher||(this.fetcher=await(async function(){const{fetchBuilder:a,FileSystemCache:d}=await r("node-fetch-cache"),c=new d({cacheDirectory:".cache/typst/fonts"}),u=a.withCache(c);return function(h,p){const m=setTimeout(()=>{console.warn("font fetching is stucking:",h)},15e3);return u(h,p).finally(()=>{clearTimeout(m)})}})()),n=t.filter(a=>a instanceof Uint8Array||typeof a=="object"&&"info"in a?!0:this.loadedFonts.has(a)?!1:(this.loadedFonts.add(a),!0)),l=await Promise.all(n.map(async a=>{if(a instanceof Uint8Array){await e.add_raw_font(a);return}if(typeof a=="object"&&"info"in a){await e.add_lazy_font(a,"blob"in a?a.blob:X(a));return}return new Uint8Array(await(await s(a)).arrayBuffer())}));for(const a of l)a&&await e.add_raw_font(a)}async build(e,t,r){const s={ref:this,builder:t,hooks:r};for(const n of(e==null?void 0:e.beforeBuild)??[])await n(void 0,s);return r.latelyBuild&&r.latelyBuild(s),await t.build()}}async function Q(i,e,t,r){var s;return await e.init((s=i==null?void 0:i.getModule)==null?void 0:s.call(i)),await new ce().build(i,new t,r)}function X(i){return()=>{const e=new XMLHttpRequest;return e.overrideMimeType("text/plain; charset=x-user-defined"),e.open("GET",i.url,!1),e.send(null),e.status===200&&(e.response instanceof String||typeof e.response=="string")?Uint8Array.from(e.response,t=>t.charCodeAt(0)):new Uint8Array}}const f=Symbol.for("reflexo-obj");var F;(function(i){i[i.PIXEL_PER_PT=3]="PIXEL_PER_PT"})(F||(F={}));const le=["DejaVuSansMono-Bold.ttf","DejaVuSansMono-BoldOblique.ttf","DejaVuSansMono-Oblique.ttf","DejaVuSansMono.ttf","LibertinusSerif-Bold.otf","LibertinusSerif-BoldItalic.otf","LibertinusSerif-Italic.otf","LibertinusSerif-Regular.otf","LibertinusSerif-Semibold.otf","LibertinusSerif-SemiboldItalic.otf","NewCM10-Bold.otf","NewCM10-BoldItalic.otf","NewCM10-Italic.otf","NewCM10-Regular.otf","NewCMMath-Bold.otf","NewCMMath-Book.otf","NewCMMath-Regular.otf"],de=["InriaSerif-Bold.ttf","InriaSerif-BoldItalic.ttf","InriaSerif-Italic.ttf","InriaSerif-Regular.ttf","Roboto-Regular.ttf","NotoSerifCJKsc-Regular.otf"],he=["TwitterColorEmoji.ttf","NotoColorEmoji-Regular-COLR.subset.ttf"];function ue(){return E([],{assets:!1})}function fe(i){return E([],i)}function me(i){var t,r;const e=[];if(i&&(i==null?void 0:i.assets)!==!1&&((t=i==null?void 0:i.assets)!=null&&t.length)&&((r=i==null?void 0:i.assets)==null?void 0:r.length)>0){let s={text:"https://cdn.jsdelivr.net/gh/typst/typst-assets@v0.13.1/files/fonts/",_:"https://cdn.jsdelivr.net/gh/typst/typst-dev-assets@v0.13.1/files/fonts/"},n=i.assetUrlPrefix??s;typeof n=="string"?n={_:n}:n={...s,...n};for(const a of Object.keys(n)){const d=n[a];d[d.length-1]!=="/"&&(n[a]=d+"/")}const l=(a,d)=>d.map(c=>(n[a]||n._)+c);for(const a of i.assets)switch(a){case"text":e.push(...l(a,le));break;case"cjk":e.push(...l(a,de));break;case"emoji":e.push(...l(a,he));break}}return e}function E(i,e){const t=me(e),r=async(s,{ref:n,builder:l})=>{e!=null&&e.fetcher&&n.setFetcher(e.fetcher),await n.loadFonts(l,[...i,...t])};return r._preloadRemoteFontOptions=e,r._kind="fontLoader",r}function T(i){return async(e,{builder:t})=>new Promise(r=>{t.set_package_registry(i,function(s){return i.resolve(s,this)}),r()})}function q(i){return async(e,t)=>{var r;if(t.alreadySetAccessModel)throw new Error(`already set some assess model before: ${(r=t.alreadySetAccessModel.constructor)==null?void 0:r.name}(${t.alreadySetAccessModel})`);return t.alreadySetAccessModel=i,new Promise(s=>{t.builder.set_access_model(i,n=>{const l=i.getMTime(n);return l?l.getTime():0},n=>i.isFile(n)||!1,n=>i.getRealPath(n)||n,n=>i.readAll(n)),s()})}}const pe=i=>{let e=!1,t;return()=>e?t:(e=!0,t=i())};class Y{constructor(e){o(this,"wasmBin");o(this,"initOnce");if(typeof e!="function")throw new Error("initFn is not a function");this.initOnce=pe(async()=>{await e(this.wasmBin)})}async init(e){this.wasmBin=e,await this.initOnce()}}var k;(function(i){i[i.vector=0]="vector",i[i.pdf=1]="pdf",i[i._dummy=2]="_dummy"})(k||(k={}));var z;z=f;class Z{constructor(e){o(this,z);this[f]=e}reset(){this[f].reset()}current(){return this[f].current()}setAttachDebugInfo(e){this[f].set_attach_debug_info(e)}}function ge(){return new re}var J;J=f;class ee{constructor(e){o(this,J);this[f]=e}compile(e){return this[f].compile(0,b(e==null?void 0:e.diagnostics))}compileHtml(e){return this[f].compile(1,b(e==null?void 0:e.diagnostics))}async query(e){return JSON.parse(this[f].query(0,e.selector,e.field))}title(){return this[f].title(0)}vector(e){return this[f].get_artifact(0,b(e==null?void 0:e.diagnostics))||{}}pdf(e){return this[f].get_artifact(1,b(e==null?void 0:e.diagnostics))||{}}setPdfOpts(e){this[f].set_pdf_opts(e)}}const te=i=>new Y(async e=>await i.default(e));function A(){return new M}class re{constructor(){o(this,"fontBuilderJs");o(this,"fontBuilder")}async init(e){var t,r;this.fontBuilderJs=await(((t=e==null?void 0:e.getWrapper)==null?void 0:t.call(e))||import("./wasm-pack-shim-DQX7lztj.js")),await te(this.fontBuilderJs).init((r=e==null?void 0:e.getModule)==null?void 0:r.call(e)),this.fontBuilder=new this.fontBuilderJs.TypstFontResolverBuilder}async getFontInfo(e){return this.fontBuilder.get_font_info(e)}async addFontData(e){this.fontBuilder.add_raw_font(e)}async addLazyFont(e,t){return this.fontBuilder.add_lazy_font(e,t)}async build(e){const t=await this.fontBuilder.build(),r=await e(t);return t.free(),r}}const x=class x{constructor(){o(this,"compiler");o(this,"compilerJs");o(this,"pdfOpts")}async init(e){var u;this.compilerJs=await(((u=e==null?void 0:e.getWrapper)==null?void 0:u.call(e))||import("./wasm-pack-shim-DQX7lztj.js"));const t=this.compilerJs.TypstCompilerBuilder,r={...e||{}},s=r.beforeBuild??(r.beforeBuild=[]),n=s.some(h=>h._preloadRemoteFontOptions!==void 0),l=s.some(h=>{var p;return((p=h._preloadRemoteFontOptions)==null?void 0:p.assets)!==void 0}),a=s.some(h=>{var p;return((p=h._preloadRemoteFontOptions)==null?void 0:p.assets)===!1});if((!n||!l&&!a)&&s.push(E([],{assets:x.defaultAssets})),!s.some(h=>h._kind==="fontLoader"))throw new Error("TypstCompiler: no font loader found, please use font loaders, e.g. loadFonts or preloadSystemFonts");const c={};this.pdfOpts&&(c.latelyBuild=h=>{h.builder.set_pdf_opts(this.pdfOpts)}),this.compiler=await Q(e,te(this.compilerJs),t,c)}setPdfOpts(e){if(this.compiler)throw new Error("setPdfOpts must be called before init()");this.pdfOpts=e}setPdfOptsForNextCompile(e){this.pdfOpts=e}setFonts(e){this.compiler.set_fonts(e)}compile(e){return new Promise(t=>{const r=this.compiler.snapshot(e.root,e.mainFilePath,W(e.inputs));if(this.pdfOpts&&r.set_pdf_opts(this.pdfOpts),"incrementalServer"in e){t(r.incr_compile(e.incrementalServer[f],b(e.diagnostics)));return}t(r.get_artifact(e.format||k.vector,b(e.diagnostics)))})}async runWithWorld(e,t){const r=this.compiler.snapshot(e.root,e.mainFilePath,W(e.inputs));let s=await t(new ee(r));return r.free(),s}query(e){return this.runWithWorld(e,async t=>JSON.parse(await t.query(e)))}getSemanticTokenLegend(){return new Promise(e=>{e(this.compiler.get_semantic_token_legend())})}getSemanticTokens(e){return new Promise(t=>{this.compiler.reset(),t(this.compiler.get_semantic_tokens(e.offsetEncoding||"utf-16",e.mainFilePath,e.resultId))})}async withIncrementalServer(e){const t=new Z(this.compiler.create_incr_server());try{return await e(t)}finally{t[f].free()}}async getAst(e){return this.compiler.get_ast(e)}async reset(){await new Promise(e=>{this.compiler.reset(),e(void 0)})}addSource(e,t){if(arguments.length>2)throw new Error("use of addSource(path, source, isMain) is deprecated, please use addSource(path, source) instead");this.compiler.add_source(e,t)}mapShadow(e,t){this.compiler.map_shadow(e,t)}unmapShadow(e){this.compiler.unmap_shadow(e)}resetShadow(){this.compiler.reset_shadow()}renderPageToCanvas(){throw new Error("Please use the api TypstRenderer.renderToCanvas in v0.4.0")}};o(x,"defaultAssets",["text"]);let M=x;A._impl=M;function W(i){return i?Object.entries(i):void 0}function b(i){switch(i){case"none":return 1;case"unix":return 2;case"full":default:return 3}}var O=Object.freeze({__proto__:null,get CompileFormatEnum(){return k},IncrementalServer:Z,TypstFontBuilderDriver:re,TypstWorld:ee,createTypstCompiler:A,createTypstFontBuilder:ge});class we{constructor(e,t,r){o(this,"pageInfos");o(this,"loadPageCount");o(this,"imageScaleFactor");o(this,"container");o(this,"canvasList");o(this,"textLayerList");o(this,"commonList");o(this,"textLayerParentList");o(this,"semanticLayerList");this.pageInfos=e,this.imageScaleFactor=r.pixelPerPt??F.PIXEL_PER_PT,t.innerHTML="",t.style.width="100%",this.container=t,this.canvasList=new Array(this.loadPageCount),this.textLayerList=new Array(this.loadPageCount),this.commonList=new Array(this.loadPageCount),this.textLayerParentList=new Array(this.loadPageCount),this.semanticLayerList=new Array(this.loadPageCount);const s=(n,l,a)=>{const d=Math.ceil(l.width)*this.imageScaleFactor,c=Math.ceil(l.height)*this.imageScaleFactor,u=this.canvasList[n]=document.createElement("canvas"),h=this.semanticLayerList[n]=document.createElement("div"),p=this.textLayerList[n]=document.createElement("div"),m=this.textLayerParentList[n]=document.createElement("div");if(u.getContext("2d")){const w=document.createElement("div");u.width=d,u.height=c,w.appendChild(u),a.appendChild(w),w.style.position="absolute"}{m.appendChild(p),m.className="typst-html-semantics";const w=t.offsetWidth,y=w/l.width;m.style.width=`${w}px`,m.style.height=`${l.height*y}px`,m.style.setProperty("--data-text-width",`${y}px`),m.style.setProperty("--data-text-height",`${y}px`),a.classList.add("typst-page"),a.classList.add("canvas"),a.style.width=`${w}px`,a.style.height=`${c*y}px`,a.style.position="relative",h.appendChild(m),a.appendChild(h)}};for(let n=0;n<this.pageInfos.length;n++){const l=this.pageInfos[n];let a;a=this.commonList[n]=document.createElement("div"),t.appendChild(a),s(n,l,a)}}resetLayout(){for(let e=0;e<this.pageInfos.length;e++){const t=this.pageInfos[e],r=Math.ceil(t.width)*this.imageScaleFactor,s=Math.ceil(t.height)*this.imageScaleFactor,n=this.canvasList[e].parentElement;if(!n)throw new Error(`canvasDiv is null for page ${e}, canvas list length ${this.canvasList.length}`);const l=this.commonList[e],a=this.textLayerParentList[e],d=this.container.offsetWidth,c=d/r;a.style.width=`${d}px`,a.style.height=`${s*c}px`,l.style.width=`${d}px`,l.style.height=`${s*c}px`;const u=this.container.offsetWidth/r;n.style.transformOrigin="0px 0px",n.style.transform=`scale(${u})`}}}var P;(function(i){i[i.Doc=0]="Doc",i[i.Slide=1]="Slide"})(P||(P={}));class ${constructor(e){o(this,"hookedElem");o(this,"kModule");o(this,"opts");o(this,"modes",[]);o(this,"partialRendering",!0);o(this,"renderMode","svg");o(this,"r");o(this,"previewMode",P.Doc);o(this,"isContentPreview",!1);o(this,"isMixinOutline",!1);o(this,"backgroundColor","black");o(this,"pageColor","white");o(this,"pixelPerPt",3);o(this,"retrieveDOMState");o(this,"isRendering",!1);o(this,"moduleInitialized",!1);o(this,"patchQueue",[]);o(this,"disposeList",[]);o(this,"canvasRenderCToken");o(this,"currentRealScale",1);o(this,"currentScaleRatio",1);o(this,"vpTimeout");o(this,"sampledRenderTime",0);o(this,"partialRenderPage",0);o(this,"outline");o(this,"cursorPosition");o(this,"cachedDOMState",{width:0,height:0,window:{innerWidth:0,innerHeight:0},boundingRect:{left:0,top:0,right:0}});var t,r;this.hookedElem=e.hookedElem,this.kModule=e.kModule,this.opts=e||{};{const{renderMode:s,previewMode:n,isContentPreview:l,retrieveDOMState:a}=e||{};this.partialRendering=!1,this.renderMode=s??this.renderMode,this.previewMode=n??this.previewMode,this.isContentPreview=l||!1,this.retrieveDOMState=a??(()=>({width:this.hookedElem.offsetWidth,height:this.hookedElem.offsetHeight,window:{innerWidth:window.innerWidth,innerHeight:window.innerHeight},boundingRect:this.hookedElem.getBoundingClientRect()})),this.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue("--typst-preview-background-color")}this.hookedElem.classList.add("hide-scrollbar-x"),(t=this.hookedElem.parentElement)==null||t.classList.add("hide-scrollbar-x"),this.previewMode===P.Slide&&(this.hookedElem.classList.add("hide-scrollbar-y"),(r=this.hookedElem.parentElement)==null||r.classList.add("hide-scrollbar-y")),this.installCtrlWheelHandler()}reset(){this.kModule.reset(),this.moduleInitialized=!1}dispose(){const e=this.disposeList;this.disposeList=[],e.forEach(t=>t())}static derive(e,t){return["rescale","rerender","postRender"].reduce((r,s)=>(r[s]=e[`${s}$${t}`].bind(e),console.assert(r[s]!==void 0,`${s}$${t} is undefined`),r),{})}registerMode(e){const t=$.derive(this,e);this.modes.push([e,t]),e===this.renderMode&&(this.r=t)}installCtrlWheelHandler(){const e=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],t=r=>{var s,n,l,a;if(r.ctrlKey){r.preventDefault(),this.cachedDOMState=this.retrieveDOMState(),window.onresize!==null&&(window.onresize=null);const d=this.currentScaleRatio;if(r.deltaY<0){if(this.currentScaleRatio>=e.at(-1))return;this.currentScaleRatio=e.filter(m=>m>this.currentScaleRatio).at(0)}else if(r.deltaY>0){if(this.currentScaleRatio<=e.at(0))return;this.currentScaleRatio=e.filter(m=>m<this.currentScaleRatio).at(-1)}else return;const c=this.currentScaleRatio/d,u=r.pageX*(c-1),h=r.pageY*(c-1);Math.abs(this.currentScaleRatio-1)<1e-5?(this.hookedElem.classList.add("hide-scrollbar-x"),(s=this.hookedElem.parentElement)==null||s.classList.add("hide-scrollbar-x"),this.previewMode===P.Slide&&(this.hookedElem.classList.add("hide-scrollbar-y"),(n=this.hookedElem.parentElement)==null||n.classList.add("hide-scrollbar-y"))):(this.hookedElem.classList.remove("hide-scrollbar-x"),(l=this.hookedElem.parentElement)==null||l.classList.remove("hide-scrollbar-x"),this.previewMode===P.Slide&&(this.hookedElem.classList.remove("hide-scrollbar-y"),(a=this.hookedElem.parentElement)==null||a.classList.remove("hide-scrollbar-y")));const p=this.hookedElem.firstElementChild;if(p){const m=this.getSvgScaleRatio(),g=Number.parseFloat(p.getAttribute("data-height")),w=Math.ceil(g*m);this.hookedElem.style.height=`${w*2}px`}return window.scrollBy(u,h),this.addViewportChange(),!1}};this.renderMode!=="dom"&&(typeof acquireVsCodeApi<"u"?(window.addEventListener("wheel",t,{passive:!1}),this.disposeList.push(()=>{window.removeEventListener("wheel",t)})):(document.body.addEventListener("wheel",t,{passive:!1}),this.disposeList.push(()=>{document.body.removeEventListener("wheel",t)})))}getSvgScaleRatio(){const e=this.hookedElem.firstElementChild;if(!e)return 0;const t=this.cachedDOMState,r=Number.parseFloat(e.getAttribute("data-width")||e.getAttribute("width")||"1"),s=Number.parseFloat(e.getAttribute("data-height")||e.getAttribute("height")||"1");return this.currentRealScale=this.previewMode===P.Slide?Math.min(t.width/r,t.height/s):t.width/r,this.currentRealScale*this.currentScaleRatio}processQueue(e){const t=e[0];switch(t){case"new":case"diff-v1":return t==="new"&&this.reset(),this.kModule.manipulateData({action:"merge",data:e[1]}),this.moduleInitialized=!0,!0;case"viewport-change":return this.moduleInitialized?!0:(console.log("viewport-change before initialization"),!1);default:return console.log("svgUpdateEvent",e),!1}}triggerUpdate(){if(this.isRendering)return;this.isRendering=!0;const e=async()=>{if(this.cachedDOMState=this.retrieveDOMState(),this.patchQueue.length===0){this.isRendering=!1,this.postprocessChanges();return}try{let t=performance.now();const r=this.canvasRenderCToken;r&&(await r.cancel(),await r.wait(),this.canvasRenderCToken=void 0,console.log("cancel canvas rendering"));let s=!1;for(;this.patchQueue.length>0;)s=this.processQueue(this.patchQueue.shift())||s;let n=performance.now();s&&(this.r.rescale(),await this.r.rerender(),this.r.rescale());let l=performance.now();const a=(d,c,u)=>`${d} ${(u-c).toFixed(2)} ms`;this.sampledRenderTime=l-t,requestAnimationFrame(e)}catch(t){console.error(t),this.isRendering=!1,this.postprocessChanges()}};requestAnimationFrame(e)}postprocessChanges(){this.r.postRender(),this.previewMode===P.Slide&&document.querySelectorAll(".typst-page-number-indicator").forEach(e=>{e.textContent=`${this.kModule.retrievePagesInfo().length}`})}addChangement(e){e[0]==="new"&&this.patchQueue.splice(0,this.patchQueue.length);const t=()=>{this.vpTimeout=void 0,this.patchQueue.push(e),this.triggerUpdate()};this.vpTimeout!==void 0&&clearTimeout(this.vpTimeout),e[0]==="viewport-change"&&this.isRendering?this.vpTimeout=setTimeout(t,this.sampledRenderTime||100):t()}addViewportChange(){this.addChangement(["viewport-change",""])}}function ye(i){return class{constructor(t){o(this,"impl");o(this,"kModule");if(t.isContentPreview&&(t.renderMode="canvas"),this.kModule=t.kModule,this.impl=new i(t),!this.impl.r)throw new Error(`mode is not supported, ${t==null?void 0:t.renderMode}`);t.isContentPreview&&(this.impl.partialRendering=!0,this.impl.pixelPerPt=1,this.impl.isMixinOutline=!0)}dispose(){this.impl.dispose()}reset(){this.impl.reset()}addChangement(t){this.impl.addChangement(t)}addViewportChange(){this.impl.addViewportChange()}setPageColor(t){this.impl.pageColor=t,this.addViewportChange()}setPartialRendering(t){this.impl.partialRendering=t}setCursor(t,r,s){this.impl.cursorPosition=[t,r,s]}setPartialPageNumber(t){return t<=0||t>this.kModule.retrievePagesInfo().length?!1:(this.impl.partialRenderPage=t-1,this.addViewportChange(),!0)}getPartialPageNumber(){return this.impl.partialRenderPage+1}setOutineData(t){this.impl.outline=t,this.addViewportChange()}}}function ve(i,...e){return e.reduce((t,r)=>r(t),i)}class Ce{constructor(){o(this,"isCancellationRequested",!1);o(this,"_onCancelled");o(this,"_onCancelledResolveResolved");let e,t;this._onCancelled=new Promise(r=>{e=r,t&&t(r)}),this._onCancelledResolveResolved=new Promise(r=>{t=r,e&&r(e)})}async cancel(){await this._onCancelledResolveResolved,this.isCancellationRequested=!0}isCancelRequested(){return this.isCancellationRequested}async consume(){(await this._onCancelledResolveResolved)()}wait(){return this._onCancelled}}const Se=()=>new Promise(i=>requestAnimationFrame(i));var B;(function(i){i[i.Doc=0]="Doc",i[i.Pages=1]="Pages"})(B||(B={}));var S;(function(i){i[i.Layout=0]="Layout",i[i.Svg=1]="Svg",i[i.Semantics=2]="Semantics",i[i.PrepareCanvas=3]="PrepareCanvas",i[i.Canvas=4]="Canvas"})(S||(S={}));function Pe(i){return class extends i{constructor(...r){super(...r);o(this,"tmpl",document.createElement("template"));o(this,"stub",this.createElement("<stub></stub>"));o(this,"plugin");o(this,"docKernel");o(this,"resourceHeader");o(this,"pages",[]);o(this,"domScale",1);o(this,"track_mode",B.Doc);o(this,"current_task");o(this,"viewport");if(this.registerMode("dom"),this.disposeList.push(()=>{this.dispose()}),this.plugin=this.opts.renderer,this.opts.domScale!==void 0){if(this.opts.domScale<=0)throw new Error("domScale must be positive");this.domScale=this.opts.domScale}}dispose(){for(const r of this.pages)r.dispose();this.docKernel&&this.docKernel.free()}createElement(r){return this.tmpl.innerHTML=r,this.tmpl.content.firstElementChild}async mountDom(r){if(this.docKernel)throw new Error("already mounted");this.hookedElem.innerHTML='<svg class="typst-svg-resources" viewBox="0 0 0 0" width="0" height="0" style="opacity: 0; position: absolute;"></svg>',this.resourceHeader=this.hookedElem.querySelector(".typst-svg-resources"),this.docKernel=await this.plugin.renderer.mount_dom(this.kModule[f],this.hookedElem),this.docKernel.bind_functions({populateGlyphs:s=>{let l=this.createElement(s).firstElementChild;this.resourceHeader.append(l)}})}async cancelAnyway$dom(){if(this.current_task){const r=this.current_task;this.current_task=void 0,await r.cancel()}}retrieveDOMPages(){return Array.from(this.hookedElem.querySelectorAll(".typst-dom-page"))}postRender$dom(){}rescale$dom(){}getDomViewport(r,s){const n=s.left,l=-s.top,a=s.right,d=r.innerHeight-s.top,c={x:0,y:l/this.domScale,width:Math.max(a-n,0)/this.domScale,height:Math.max(d-l,0)/this.domScale};return(c.width<=0||c.height<=0)&&(c.x=c.y=c.width=c.height=0),c}async rerender$dom(){const r=this.retrieveDOMState(),{x:s,y:n,width:l,height:a}=this.getDomViewport(r.window,r.boundingRect);if(!await this.docKernel.relayout(s,n,l,a))return;const c=new Ce;this.doRender$dom(c),this.current_task=c}async doRender$dom(r){const s=(d,c)=>{if(d&&!r.isCancelRequested()&&c)return c()},n=this.retrieveDOMPages().map(d=>{const{innerWidth:c,innerHeight:u}=window,h=d.getBoundingClientRect();return{inWindow:!(h.left>c||h.right<0||h.top>u||h.bottom<0),page:d}}),l=async d=>{if(await Se(),r.isCancelRequested())return;const c=n[d].page,u=c.getBoundingClientRect(),h=this.getDomViewport(window,u),p=C=>this.docKernel.need_repaint(d,h.x,h.y,h.width,h.height,C),m=C=>this.docKernel.repaint(d,h.x,h.y,h.width,h.height,C),g=C=>{if(!r.isCancelRequested())return s(p(C),()=>m(C))};await g(S.Layout);const w=(u.width?Number.parseFloat(c.getAttribute("data-width"))/u.width:1)*this.domScale,y=(u.height?Number.parseFloat(c.getAttribute("data-height"))/u.height:1)*this.domScale;h.x*=w,h.y*=y,h.y-=100,h.width*=w,h.height*=y,h.height+=200,await g(S.Svg),await g(S.Semantics),!r.isCancelRequested()&&(p(S.PrepareCanvas)?(async()=>{if(await m(S.PrepareCanvas),!r.isCancelRequested())return g(S.Canvas)})():await g(S.Canvas))},a=async d=>{for(let c=0;c<n.length;++c){if(r.isCancelRequested())return;n[c].inWindow===d&&await l(c)}};this.cancelAnyway$dom(),await a(!0),await a(!1),r.isCancelRequested()}}}class _e extends ye(ve($,Pe)){}var K;K=f;class L{constructor(e,t){o(this,"plugin");o(this,K);this.plugin=e,this[f]=t}set backgroundColor(e){e!==void 0&&(this[f].background_color=e)}get backgroundColor(){return this[f].background_color}set pixelPerPt(e){e!==void 0&&(this[f].pixel_per_pt=e)}get pixelPerPt(){return this[f].pixel_per_pt}reset(){this.plugin.resetSession(this)}get doc_width(){return this[f].doc_width}get docWidth(){return this[f].doc_width}get doc_height(){return this[f].doc_height}get docHeight(){return this[f].doc_height}retrievePagesInfo(){const e=this[f].pages_info,t=[],r=e.page_count;for(let s=0;s<r;s++){const n=e.page(s);t.push({pageOffset:n.page_off,width:n.width_pt,height:n.height_pt})}return t}getSourceLoc(e){return this[f].source_span(e)}renderSvg(e){return this.plugin.renderSvg({renderSession:this,...e})}renderToSvg(e){return this.plugin.renderToSvg({renderSession:this,...e})}renderCanvas(e){return this.plugin.renderCanvas({renderSession:this,...e})}manipulateData(e){this.plugin.manipulateData({renderSession:this,...e})}renderSvgDiff(e){return this.plugin.renderSvgDiff({renderSession:this,...e})}get_source_loc(e){return this[f].source_span(e)}render_in_window(e,t,r,s){return this[f].render_in_window(e,t,r,s)}merge_delta(e){this.plugin.manipulateData({renderSession:this,action:"merge",data:e})}}var R;(function(i){i[i.Delete=0]="Delete",i[i.New=1]="New",i[i.Update=2]="Update"})(R||(R={}));var G;G=f;class se{constructor(e,t){o(this,"plugin");o(this,G);o(this,"managedCanvasElemList",new Map);o(this,"canvasCounter",Math.random());this.plugin=e,this[f]=t}manipulateData(e,t){return this[f].manipulate_data(e,t)}renderCanvas(e){const t=this.managedCanvasElemList;for(const[a,d]of t)d[0]=R.Delete;for(const a of e){const d=a.canvas;let c=d.dataset.manageId,u=R.Update;c||(c=this.canvasCounter.toFixed(5),this.canvasCounter+=1,d.dataset.manageId=c,u=R.New);let h=t.get(c);if(h&&h[0]!==R.Delete)throw new Error("cannot update a canvas for two times in batch");t.set(c,[u,{...a}])}const r=Array.from(t.entries()),s=new Uint8Array(r.length),n=new Array(r.length),l=r.map(([a,[d,c]],u)=>(d||t.delete(a),s[u]=d,n[u]=c.canvas,this.plugin.canvasOptionsToRust(c)));return this[f].render_canvas(s,n,l)}async retrievePagesInfo(){const e=await this[f].get_pages_info();console.log(e);const t=[],r=e.page_count;for(let s=0;s<r;s++){const n=e.page(s);t.push({pageOffset:n.page_off,width:n.width_pt,height:n.height_pt})}return t}}const be=i=>new Y(async e=>await i.default(e));function ie(){return new ne}let N=!0;class ne{constructor(){o(this,"renderer");o(this,"rendererJs")}async init(e){var r;this.rendererJs=await(((r=e==null?void 0:e.getWrapper)==null?void 0:r.call(e))||import("./wasm-pack-shim-DV_YLnND.js"));const t=this.rendererJs.TypstRendererBuilder;this.renderer=await Q(e,be(this.rendererJs),t,{})}loadGlyphPack(e){return Promise.resolve()}createOptionsToRust(e){const t=new this.rendererJs.CreateSessionOptions;return e.format!==void 0&&(t.format=e.format),e.artifactContent!==void 0&&(t.artifact_content=e.artifactContent),t}canvasOptionsToRust(e){const t=new this.rendererJs.RenderPageImageOptions;if(e.pageOffset===void 0)throw new Error("pageOffset is required in reflexo v0.5.0");if(t.page_off=e.pageOffset,e.cacheKey!==void 0&&(t.cache_key=e.cacheKey),e.backgroundColor!==void 0&&(t.background_color=e.backgroundColor),e.pixelPerPt!==void 0&&(t.pixel_per_pt=e.pixelPerPt),e.dataSelection!==void 0){let r=0;e.dataSelection.body?r|=1:e.canvas&&N&&(N=!1,console.warn("dataSelection.body is not set but providing canvas for body")),(e.dataSelection.text||e.dataSelection.annotation)&&console.error("dataSelection.text and dataSelection.annotation are deprecated"),e.dataSelection.semantics&&(r|=8),t.data_selection=r}return t}retrievePagesInfoFromSession(e){return e.retrievePagesInfo()}renderCanvas(e){return this.withinOptionSession(e,async t=>this.renderer.render_page_to_canvas(t[f],e.canvas||void 0,this.canvasOptionsToRust(e)))}async inAnimationFrame(e){return new Promise((t,r)=>{requestAnimationFrame(()=>{try{t(e())}catch(s){r(s)}})})}async renderDisplayLayer(e,t,r){const n=e[f].pages_info.page_count,l=async(u,h)=>{const m=t[u].getContext("2d");if(!m)throw new Error("canvas context is null");return await this.renderCanvas({...r,canvas:m,renderSession:e,pageOffset:h})},a=performance.now(),d=await(async()=>{const u=[];for(let h=0;h<n;h++)u.push(await this.inAnimationFrame(()=>l(h,h)));return u})(),c=performance.now();return console.log(`display layer used: render = ${(c-a).toFixed(1)}ms`),d}renderTextLayer(e,t){const r=performance.now();e.forEach((n,l)=>{n.innerHTML=t[l].htmlSemantics[0]});const s=performance.now();console.log(`text layer used: render = ${(s-r).toFixed(1)}ms`)}async render(e){if("format"in e&&e.format!=="vector"&&["serde_json","js","ir"].includes(e.format))throw new Error(`deprecated format ${e.format}, please use vector format`);return this.renderToCanvas(e)}async renderDom(e){if("format"in e&&e.format!=="vector"&&["serde_json","js","ir"].includes(e.format))throw new Error(`deprecated format ${e.format}, please use vector format`);return this.withinOptionSession(e,async t=>{const r=new _e({...e,renderMode:"dom",hookedElem:e.container,kModule:t,renderer:this});return await r.impl.mountDom(e.pixelPerPt),r})}async renderToCanvas(e){let t,r;const s=e.container;s.style.visibility="hidden";const n=async(l,a)=>{try{r=await this.renderDisplayLayer(t,l,e),a()}finally{s.style.visibility="visible"}};return this.withinOptionSession(e,async l=>{if(t=l,t[f].pages_info.page_count===0)throw new Error("No page found in session");if(e.pixelPerPt!==void 0&&e.pixelPerPt<=0)throw new Error("Invalid typst.RenderOptions.pixelPerPt, should be a positive number "+e.pixelPerPt);let a=e.backgroundColor;if(a!==void 0&&!/^#[0-9a-f]{6}$/.test(a))throw new Error("Invalid typst.backgroundColor color for matching ^#?[0-9a-f]{6}$ "+a);t.pixelPerPt=e.pixelPerPt??F.PIXEL_PER_PT,t.backgroundColor=a??"#ffffff";const d=performance.now(),c=new we(this.retrievePagesInfoFromSession(t),s,e),u=performance.now();console.log(`layer used: retrieve = ${(u-d).toFixed(1)}ms`),await n(c.canvasList,()=>c.resetLayout()),this.renderTextLayer(c.textLayerList,r)})}createModule(e){return Promise.resolve(new L(this,this.renderer.create_session(e&&this.createOptionsToRust({format:"vector",artifactContent:e}))))}async createWorkerV0(e){return new se(this,await this.renderer.create_worker(e))}workerBridge(){return this.renderer.create_worker_bridge()}renderSvg(e,t){if(e instanceof L||t)throw new Error("removed api, please use renderToSvg({ renderSession, container }) instead");return this.withinOptionSession(e,async r=>{let s;return e.data_selection&&(s=0,e.data_selection.body&&(s|=1),e.data_selection.defs&&(s|=2),e.data_selection.css&&(s|=4),e.data_selection.js&&(s|=8)),Promise.resolve(this.renderer.svg_data(r[f],s))})}renderSvgDiff(e){return e.window?this.renderer.render_svg_diff(e.renderSession[f],e.window.lo.x,e.window.lo.y,e.window.hi.x,e.window.hi.y):this.renderer.render_svg_diff(e.renderSession[f],0,0,1e33,1e33)}renderToSvg(e){return this.withinOptionSession(e,async t=>Promise.resolve(this.renderer.render_svg(t[f],e.container)))}getCustomV1(e){return Promise.resolve(this.renderer.get_customs(e.renderSession[f]))}resetSession(e){return this.renderer.reset(e[f])}manipulateData(e){return this.renderer.manipulate_data(e.renderSession[f],e.action??"reset",e.data)}withinOptionSession(e,t){function r(s){return"artifactContent"in s}if("renderSession"in e)return t(e.renderSession);if(r(e))return this.runWithSession(e,t);throw new Error("Invalid render options, should be one of RenderByContentOptions|RenderBySessionOptions")}async runWithSession(e,t){let r=e,s=t;t||(r=void 0,s=e);const n=this.renderer.create_session(r&&this.createOptionsToRust(r));try{const l=await s(new L(this,n));return n.free(),l}catch(l){throw n.free(),l}}}var j=Object.freeze({__proto__:null,RenderSession:L,TypstRendererDriver:ne,TypstWorker:se,createTypstRenderer:ie});class U{constructor(){o(this,"mTimes",new Map);o(this,"mData",new Map)}reset(){this.mTimes.clear(),this.mData.clear()}insertFile(e,t,r){this.mTimes.set(e,r),this.mData.set(e,t)}removeFile(e){this.mTimes.delete(e),this.mData.delete(e)}getMTime(e){if(e.startsWith("/@memory/")&&this.mTimes.has(e))return this.mTimes.get(e)}isFile(){return!0}getRealPath(e){return e}readAll(e){if(e.startsWith("/@memory/")&&this.mData.has(e))return this.mData.get(e)}}class V{constructor(e){o(this,"am");o(this,"cache",new Map);this.am=e}resolvePath(e){return`https://packages.typst.org/preview/${e.name}-${e.version}.tar.gz`}pullPackageData(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",this.resolvePath(e),!1),t.send(null),t.status===200&&(t.response instanceof String||typeof t.response=="string"))return Uint8Array.from(t.response,r=>r.charCodeAt(0))}resolve(e,t){if(e.namespace!=="preview")return;const r=this.resolvePath(e);if(this.cache.has(r))return this.cache.get(r)();const s=this.pullPackageData(e);if(!s)return;const n=`/@memory/fetch/packages/${e.namespace}/${e.name}/${e.version}`,l=[];t.untar(s,(d,c,u)=>{l.push([n+"/"+d,c,new Date(u)])});const a=()=>{for(const[d,c,u]of l)this.am.insertFile(d,c,u);return n};return this.cache.set(r,a),a()}}function Re(i){return Math.random().toString(36).replace("0.","")}const ke=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;class v{constructor(e){o(this,"mainFilePath");o(this,"cc");o(this,"fr");o(this,"ex");o(this,"providers");o(this,"ccOptions");o(this,"exOptions");o(this,"prepareUseOnce");this.cc=(e==null?void 0:e.compiler)||v.buildLocalCompiler,this.fr=(e==null?void 0:e.fontResolver)||v.buildLocalFontResolver,this.ex=(e==null?void 0:e.renderer)||v.buildLocalRenderer,this.mainFilePath="/main.typ",this.providers=[]}setCompiler(e){this.cc=e}async getFontResolver(){return typeof this.fr=="function"?this.fr=await this.fr():this.fr}async getCompiler(){return typeof this.cc=="function"?this.cc=await this.cc():this.cc}async getCompilerReset(){const e=await this.getCompiler();return await e.reset(),e}setRenderer(e){this.ex=e}async getRenderer(){return typeof this.ex=="function"?this.ex=await this.ex():this.ex}use(...e){if(!this.providers)throw new Error("already prepare uses for instances");this.providers.push(...e)}static preloadFontFromUrl(e){return v.preloadFonts([e])}static preloadFontData(e){return v.preloadFonts([e])}static preloadFonts(e){return{key:"access-model",forRoles:["compiler"],provides:[E(e)]}}static disableDefaultFontAssets(){return{key:"access-model",forRoles:["compiler"],provides:[ue()]}}static preloadFontAssets(e){return{key:"access-model",forRoles:["compiler"],provides:[fe(e)]}}static withAccessModel(e){return{key:"access-model",forRoles:["compiler"],provides:[q(e)]}}static withPackageRegistry(e){return{key:"package-registry",forRoles:["compiler"],provides:[T(e)]}}static fetchPackageRegistry(e){const t=e||new U,r=[...e?[]:[q(t)],T(new V(t))];return{key:"package-registry$fetch",forRoles:["compiler"],provides:r}}static fetchPackageBy(e,t){class r extends V{pullPackageData(n){return t(n,this.resolvePath(n))}}return{key:"package-registry$lambda",forRoles:["compiler"],provides:[T(new r(e))]}}setCompilerInitOptions(e){this.requireIsUninitialized("compiler",this.cc),this.ccOptions=e}setRendererInitOptions(e){this.requireIsUninitialized("renderer",this.ex),this.exOptions=e}setMainFilePath(e){this.mainFilePath=e}getMainFilePath(){return this.mainFilePath}removeTmp(e){return e.mainFilePath.startsWith("/tmp/")?this.unmapShadow(e.mainFilePath):Promise.resolve()}async setFonts(e){const t=await this.getFontResolver();for(const s of e)await t.addLazyFont(s,"blob"in s?s.blob:X(s),s);const r=await this.getCompiler();await t.build(async s=>r.setFonts(s))}async addSource(e,t){(await this.getCompiler()).addSource(e,t)}async resetShadow(){(await this.getCompiler()).resetShadow()}async mapShadow(e,t){(await this.getCompiler()).mapShadow(e,t)}async unmapShadow(e){(await this.getCompiler()).unmapShadow(e)}async vector(e){const t=await this.getCompileOptions(e);return(await this.getCompilerReset()).compile(t).then(s=>s.result).finally(()=>this.removeTmp(t))}async pdf(e){const t=await this.getCompileOptions(e);return t.format=k.pdf,(await this.getCompilerReset()).compile(t).then(s=>s.result).finally(()=>this.removeTmp(t))}async svg(e){return this.transientRender(e,(t,r)=>t.renderSvg({...e,renderSession:r}))}async canvas(e,t){return this.transientRender(t,(r,s)=>r.renderToCanvas({container:e,...t,renderSession:s}))}async query(e){const t=await this.getCompileOptions(e);return(await this.getCompilerReset()).query({...e,...t}).finally(()=>this.removeTmp(t))}async getSemanticTokenLegend(){return(await this.getCompilerReset()).getSemanticTokenLegend()}async getSemanticTokens(e){const t=await this.getCompileOptions(e);return(await this.getCompilerReset()).getSemanticTokens({mainFilePath:t.mainFilePath,resultId:e.resultId}).finally(()=>this.removeTmp(t))}async getCompileOptions(e){if(e===void 0)return{mainFilePath:this.mainFilePath,diagnostics:"none"};if(typeof e=="string")throw new Error("please specify opts as {mainContent: '...'} or {mainFilePath: '...'}");if("mainFilePath"in e)return{...e,diagnostics:"none"};{const t=`/tmp/${Re()}.typ`;return await this.addSource(t,e.mainContent),{mainFilePath:t,inputs:e.inputs,diagnostics:"none"}}}async getVector(e){if(e&&"vectorData"in e)return e.vectorData;const t=await this.getCompileOptions(e);return(await this.getCompiler()).compile(t).then(r=>r.result).finally(()=>this.removeTmp(t))}async transientRender(e,t){const r=await this.getRenderer();if(!r)throw new Error("does not provide renderer instance");const s=await this.getVector(e);return await r.runWithSession(async n=>(r.manipulateData({renderSession:n,action:"reset",data:s}),t(r,n)))}async prepareUse(){return this.prepareUseOnce?this.prepareUseOnce:this.prepareUseOnce=this.doPrepareUse()}async doPrepareUse(){if(!this.providers)return;const e=await Promise.all(this.providers.map(a=>typeof a=="function"?a():a));if(this.providers=[],D==this&&!e.some(a=>a.key.includes("package-registry")||a.key.includes("access-model")))if(ke){const a=new Function("m","return import(m)");try{const d=new U,{default:c}=await a("sync-request");D.use(v.withAccessModel(d),v.fetchPackageBy(d,(u,h)=>{const p=c("GET",h);if(p.statusCode===200)return p.getBody(void 0)}))}catch{}}else D.use(v.fetchPackageRegistry());const t=await Promise.all(this.providers.map(a=>typeof a=="function"?a():a)),r=this.ccOptions||(this.ccOptions={}),s=r.beforeBuild||(r.beforeBuild=[]),n=this.exOptions||(this.exOptions={}),l=n.beforeBuild||(n.beforeBuild=[]);for(const a of[...e,...t])a.forRoles.includes("compiler")&&(this.requireIsUninitialized("compiler",this.cc),s.push(...a.provides)),a.forRoles.includes("renderer")&&(this.requireIsUninitialized("renderer",this.ex),l.push(...a.provides));this.providers=void 0}requireIsUninitialized(e,t,r){if(t&&typeof t!="function")throw new Error(`${e} has been initialized: ${t}`)}static async buildLocalCompiler(){const{createTypstCompiler:e}=await Promise.resolve().then(function(){return O});await this.prepareUse();const t=e();return await t.init(this.ccOptions),t}static async buildLocalFontResolver(){const{createTypstFontBuilder:e}=await Promise.resolve().then(function(){return O});await this.prepareUse();const t=e();return await t.init(this.ccOptions),t}static async buildGlobalCompiler(){const{createGlobalCompiler:e}=await import("./global-compiler-DJrFC2AB.js"),{createTypstCompiler:t}=await Promise.resolve().then(function(){return O});return await this.prepareUse(),e(t,this.ccOptions)}static async buildLocalRenderer(){const{createTypstRenderer:e}=await Promise.resolve().then(function(){return j});await this.prepareUse();const t=e();return await t.init(this.exOptions),t}static async buildGlobalRenderer(){const{createGlobalRenderer:e}=await import("./global-renderer-DUcYUtW_.js"),{createTypstRenderer:t}=await Promise.resolve().then(function(){return j});return await this.prepareUse(),e(t,this.exOptions)}}const D=new v({compiler:v.buildGlobalCompiler,renderer:v.buildGlobalRenderer});let _=null,I=null,H=!1;const Le=["DejaVuSansMono-Bold.ttf","DejaVuSansMono-BoldOblique.ttf","DejaVuSansMono-Oblique.ttf","DejaVuSansMono.ttf","LibertinusSerif-Bold.otf","LibertinusSerif-BoldItalic.otf","LibertinusSerif-Italic.otf","LibertinusSerif-Regular.otf","LibertinusSerif-Semibold.otf","LibertinusSerif-SemiboldItalic.otf","NewCM10-Bold.otf","NewCM10-BoldItalic.otf","NewCM10-Italic.otf","NewCM10-Regular.otf","NewCMMath-Bold.otf","NewCMMath-Book.otf","NewCMMath-Regular.otf"];async function Fe(i="/assets/fonts"){const e=[];try{const s=await fetch(`${i}/fonts.json`);if(s.ok){const n=await s.json();e.push(...n.map(l=>`${i}/${l}`))}}catch{console.warn("fonts.json not found, using default font list"),e.push(...Le.map(s=>`${i}/${s}`))}const t=e.map(async s=>{try{const n=await fetch(s);if(!n.ok)return console.warn(`Failed to fetch font: ${s}`),null;const l=await n.arrayBuffer();return new Uint8Array(l)}catch(n){return console.warn(`Error loading font ${s}:`,n),null}});return(await Promise.all(t)).filter(s=>s!==null)}async function Me(){if(H)return;const i=await Fe(),e=v.fetchPackageRegistry();_=A(),await _.init({getModule:()=>"/core/typst-ts-web-compiler/pkg/typst_ts_web_compiler_bg.wasm",beforeBuild:[...e.provides,async(t,{builder:r})=>{for(const s of i)await r.add_raw_font(s)}]}),I=ie(),await I.init({getModule:()=>"/core/typst-ts-renderer/pkg/typst_ts_renderer_bg.wasm",beforeBuild:[async(t,{builder:r})=>{for(const s of i)await r.add_raw_font(s)}]}),H=!0}function xe(i){switch(i){case"vector":return 0;case"pdf":return 1;default:throw new Error(`Unsupported format: ${i}`)}}self.addEventListener("message",async i=>{const e=i.data,{id:t,type:r}=e;try{if(r==="ping"){const g={id:t,type:"pong"};self.postMessage(g);return}await Me();const{payload:s}=e,{mainFilePath:n,sources:l,format:a,pdfOptions:d}=s;_.resetShadow();for(const[g,w]of Object.entries(l)){const y=g.startsWith("/")?g:`/${g}`;typeof w=="string"?_.addSource(y,w):_.mapShadow(y,w)}const c=n.startsWith("/")?n:`/${n}`;let u,h=[];if(a==="pdf"){const g=(d==null?void 0:d.pdfStandard)||'"1.7"',w=(d==null?void 0:d.pdfTags)!==void 0?d.pdfTags:!0,y=(d==null?void 0:d.creationTimestamp)||Math.floor(Date.now()/1e3);_.setPdfOptsForNextCompile({pdf_standard:g,pdf_tags:w,creation_timestamp:y});const C=await _.compile({mainFilePath:c,format:xe("pdf")});if(console.log("[Typst Worker] Compile result:",C),console.log("[Typst Worker] Diagnostics:",C.diagnostics),u=C.result,h=C.diagnostics||[],!u||u.byteLength===0)throw console.error("[Typst Worker] No output from compiler!"),new Error("Compiler returned empty output")}else{const g=await _.compile({mainFilePath:c,format:"vector"});if(h=g.diagnostics||[],!g.result||g.result.byteLength===0){const w=[],y={id:t,type:"done",result:{format:a,output:new Uint8Array(0),diagnostics:h}};self.postMessage(y,w);return}u=await I.renderSvg({artifactContent:g.result})}const p=u instanceof Uint8Array?[u.buffer]:[],m={id:t,type:"done",result:{format:a,output:u,diagnostics:h}};self.postMessage(m,p)}catch(s){const n=typeof s=="object"&&s&&"message"in s?String(s.message):String(s),l={id:t,type:"error",error:n};self.postMessage(l)}});
//# sourceMappingURL=typst.worker-DaZY_zu0.js.map
