{"version":3,"file":"global-renderer-DUcYUtW_.js","sources":["../node_modules/@myriaddreamin/typst.ts/dist/esm/contrib/global-renderer.mjs"],"sourcesContent":["let globalRenderer = undefined;\nlet globalRendererInitReady;\nlet isReady = false;\nexport function getGlobalRenderer() {\n    return isReady ? globalRenderer : undefined;\n}\nexport function createGlobalRenderer(creator, initOptions) {\n    // todo: determine renderer thread-safety\n    // todo: check inconsistent initOptions\n    const renderer = globalRenderer || creator();\n    if (globalRendererInitReady !== undefined) {\n        return globalRendererInitReady;\n    }\n    return (globalRendererInitReady = (async () => {\n        isReady = true;\n        await renderer.init(initOptions);\n        return (globalRenderer = renderer);\n    })());\n}\nexport function withGlobalRenderer(creator, initOptions, resolve, reject) {\n    const renderer = getGlobalRenderer();\n    if (renderer) {\n        resolve(renderer);\n        return;\n    }\n    createGlobalRenderer(creator, initOptions).then(resolve).catch(reject);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFsLXJlbmRlcmVyLm1qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb250cmliL2dsb2JhbC1yZW5kZXJlci5tdHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsSUFBSSxjQUFjLEdBQThCLFNBQVMsQ0FBQztBQUMxRCxJQUFJLHVCQUErQyxDQUFDO0FBQ3BELElBQUksT0FBTyxHQUFHLEtBQUssQ0FBQztBQUVwQixNQUFNLFVBQVUsaUJBQWlCO0lBQy9CLE9BQU8sT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUM5QyxDQUFDO0FBRUQsTUFBTSxVQUFVLG9CQUFvQixDQUNsQyxPQUE0QixFQUM1QixXQUFrQztJQUVsQyx5Q0FBeUM7SUFDekMsdUNBQXVDO0lBQ3ZDLE1BQU0sUUFBUSxHQUFHLGNBQWMsSUFBSSxPQUFPLEVBQUUsQ0FBQztJQUU3QyxJQUFJLHVCQUF1QixLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzFDLE9BQU8sdUJBQXVCLENBQUM7SUFDakMsQ0FBQztJQUVELE9BQU8sQ0FBQyx1QkFBdUIsR0FBRyxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQzVDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDZixNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDakMsT0FBTyxDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUMsQ0FBQztJQUNyQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDUixDQUFDO0FBRUQsTUFBTSxVQUFVLGtCQUFrQixDQUNoQyxPQUE0QixFQUM1QixXQUE2QyxFQUM3QyxPQUEwQyxFQUMxQyxNQUEyQjtJQUUzQixNQUFNLFFBQVEsR0FBRyxpQkFBaUIsRUFBRSxDQUFDO0lBQ3JDLElBQUksUUFBUSxFQUFFLENBQUM7UUFDYixPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEIsT0FBTztJQUNULENBQUM7SUFFRCxvQkFBb0IsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN6RSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBJbml0T3B0aW9ucyB9IGZyb20gJy4uL29wdGlvbnMuaW5pdC5tanMnO1xuaW1wb3J0IHR5cGUgeyBUeXBzdFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIubWpzJztcblxubGV0IGdsb2JhbFJlbmRlcmVyOiBUeXBzdFJlbmRlcmVyIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xubGV0IGdsb2JhbFJlbmRlcmVySW5pdFJlYWR5OiBQcm9taXNlPFR5cHN0UmVuZGVyZXI+O1xubGV0IGlzUmVhZHkgPSBmYWxzZTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbFJlbmRlcmVyKCk6IFR5cHN0UmVuZGVyZXIgfCB1bmRlZmluZWQge1xuICByZXR1cm4gaXNSZWFkeSA/IGdsb2JhbFJlbmRlcmVyIDogdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlR2xvYmFsUmVuZGVyZXIoXG4gIGNyZWF0b3I6ICgpID0+IFR5cHN0UmVuZGVyZXIsXG4gIGluaXRPcHRpb25zPzogUGFydGlhbDxJbml0T3B0aW9ucz4sXG4pOiBQcm9taXNlPFR5cHN0UmVuZGVyZXI+IHtcbiAgLy8gdG9kbzogZGV0ZXJtaW5lIHJlbmRlcmVyIHRocmVhZC1zYWZldHlcbiAgLy8gdG9kbzogY2hlY2sgaW5jb25zaXN0ZW50IGluaXRPcHRpb25zXG4gIGNvbnN0IHJlbmRlcmVyID0gZ2xvYmFsUmVuZGVyZXIgfHwgY3JlYXRvcigpO1xuXG4gIGlmIChnbG9iYWxSZW5kZXJlckluaXRSZWFkeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGdsb2JhbFJlbmRlcmVySW5pdFJlYWR5O1xuICB9XG5cbiAgcmV0dXJuIChnbG9iYWxSZW5kZXJlckluaXRSZWFkeSA9IChhc3luYyAoKSA9PiB7XG4gICAgaXNSZWFkeSA9IHRydWU7XG4gICAgYXdhaXQgcmVuZGVyZXIuaW5pdChpbml0T3B0aW9ucyk7XG4gICAgcmV0dXJuIChnbG9iYWxSZW5kZXJlciA9IHJlbmRlcmVyKTtcbiAgfSkoKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoR2xvYmFsUmVuZGVyZXIoXG4gIGNyZWF0b3I6ICgpID0+IFR5cHN0UmVuZGVyZXIsXG4gIGluaXRPcHRpb25zOiBQYXJ0aWFsPEluaXRPcHRpb25zPiB8IHVuZGVmaW5lZCxcbiAgcmVzb2x2ZTogKHJlbmRlcmVyOiBUeXBzdFJlbmRlcmVyKSA9PiB2b2lkLFxuICByZWplY3Q/OiAoZXJyOiBhbnkpID0+IHZvaWQsXG4pIHtcbiAgY29uc3QgcmVuZGVyZXIgPSBnZXRHbG9iYWxSZW5kZXJlcigpO1xuICBpZiAocmVuZGVyZXIpIHtcbiAgICByZXNvbHZlKHJlbmRlcmVyKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjcmVhdGVHbG9iYWxSZW5kZXJlcihjcmVhdG9yLCBpbml0T3B0aW9ucykudGhlbihyZXNvbHZlKS5jYXRjaChyZWplY3QpO1xufVxuIl19"],"names":["globalRenderer","globalRendererInitReady","createGlobalRenderer","creator","initOptions","renderer"],"mappings":"AAAA,IAAIA,EACAC,EAKG,SAASC,EAAqBC,EAASC,EAAa,CAGvD,MAAMC,EAAWL,GAAkBG,EAAO,EAC1C,OAAIF,IAA4B,OACrBA,EAEHA,GAA2B,UAE/B,MAAMI,EAAS,KAAKD,CAAW,EACvBJ,EAAiBK,IAC5B,CACL","x_google_ignoreList":[0]}